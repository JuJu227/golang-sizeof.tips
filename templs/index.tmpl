{{ define "top"}}
<div class="navbar-header">
  <a class="navbar-brand" href="/">The gopher below will explain your type size...</a>
</div>
<button type="button" class="btn btn-success" id="go">Ask him!</button>
<button type="button" class="btn btn-info" id="share">Share</button>
{{ end }}
{{ define "content" }}
<div class="row">
  <div class="col-md-6">
  <h2>unsafe.Sizeof(</h2>
      <div class="gopher">
        <div id="editor">{{ .Code }}</div>
      </div>
  <h2 class="closing">)</h2>
  </div>
  <div class="col-md-6 results">
    <div class="results-inner">
{{ if .Error }}
    <div style="color:red">{{ .Error }}</div>
{{ else }}
{{ with .Result }}
      <h3>unsafe.Sizeof(): {{ .Sizeof }}</h3>
{{ if .IsStruct }}{{ if .Details }}
      <h3>unsafe.Alignof(): {{ .Alignof }}</h3>
      <h3>Details:</h3>
      <div class="table-wrap">
      <table>
         <tr>
           <th>Fields</th>
           <th>Aligment</th>
         </tr>
{{ range $row := .Details }}
        <tr>
          <td>{{ $row.Name }}</td>
          <td>
  {{ $len := $row.Chunks | len }}
  {{ range $i, $ch := $row.Chunks }}
    {{ if and (gt $len 4) (unvischunk $i $len) }}
    {{ else }}
      {{ if and (gt $len 4) (eq $i 2) }}...<br/>{{ else }}
        {{ range $filled := $ch.Cells }}
            <div class="chnk{{ if $ch.IsPadding }} pad{{ end }}{{ if not $filled }} empty{{ end }}"></div>
        {{ end }}
            <br/>
      {{ end }}
    {{ end }}
  {{ end }}
          </td>
          <td>{{ if (gt $len 4) }}{{ $len }} total{{ end }}</td>
        </tr>
{{ end }}
      </table>
      </div>
{{ end }}{{ end }}
{{ end }}
{{ end }}
    </div>
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.3/jquery.min.js" type="text/javascript"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/ace/1.1.3/ace.js" type="text/javascript"></script>
<script>
    $(function() {
        var editor = ace.edit("editor");
        editor.setTheme("ace/theme/monokai");
        editor.getSession().setMode("ace/mode/golang");
        $("#go").click(function() {
            window.location.href = '?t=' + window.btoa(editor.getSession().getValue())
        });
    });
</script>
{{ end }}
